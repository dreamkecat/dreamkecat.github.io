{
    "version": "https://jsonfeed.org/version/1",
    "title": "我他喵的 • All posts by \"逆向\" tag",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2022/05/12/%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/",
            "url": "http://example.com/2022/05/12/%E6%BB%B4%E6%B0%B4%E9%80%86%E5%90%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/",
            "title": "滴水逆向_学习笔记",
            "date_published": "2022-05-12T02:10:58.000Z",
            "content_html": "<h1 id=\"20220512开始加速学习逆向以滴水逆向的教程为路线\"><a class=\"markdownIt-Anchor\" href=\"#20220512开始加速学习逆向以滴水逆向的教程为路线\">#</a> 20220512 开始加速学习逆向，以滴水逆向的教程为路线。</h1>\n<p>下面的内容基于 32 位 pe 程序</p>\n<h2 id=\"1进制\"><a class=\"markdownIt-Anchor\" href=\"#1进制\">#</a> 1，进制</h2>\n<p>8 进制的 2-3.（32 位）</p>\n<p>010 - 011</p>\n<p>补码加法：0000 0000 0000 0000 0000 0000 0000 0010 +  1111 1111 1111 1111 1111 1111 1111 1101</p>\n<p>结果 17777777777…(8)</p>\n<h2 id=\"2exe执行文件如何执行程序\"><a class=\"markdownIt-Anchor\" href=\"#2exe执行文件如何执行程序\">#</a> 2，EXE 执行文件如何执行程序</h2>\n<p><img data-src=\"https://img-blog.csdnimg.cn/e9028542f2504e34b2dbe6706c8cbd79.png\" alt=\"img\"></p>\n<p>什么是程序。什么是数据</p>\n<p>程序是数据与可执行代码的组合。</p>\n<p>PE 文件结构</p>\n<h3 id=\"dos头\"><a class=\"markdownIt-Anchor\" href=\"#dos头\">#</a> dos 头</h3>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">IMAGE_DOS_HEADER</span> &#123;</span>      <span class=\"comment\">// DOS .EXE header</span></span><br><span class=\"line\">    WORD   e_magic;                     <span class=\"comment\">// Magic number</span></span><br><span class=\"line\">    WORD   e_cblp;                      <span class=\"comment\">// Bytes on last page of file</span></span><br><span class=\"line\">    WORD   e_cp;                        <span class=\"comment\">// Pages in file</span></span><br><span class=\"line\">    WORD   e_crlc;                      <span class=\"comment\">// Relocations</span></span><br><span class=\"line\">    WORD   e_cparhdr;                   <span class=\"comment\">// Size of header in paragraphs</span></span><br><span class=\"line\">    WORD   e_minalloc;                  <span class=\"comment\">// Minimum extra paragraphs needed</span></span><br><span class=\"line\">    WORD   e_maxalloc;                  <span class=\"comment\">// Maximum extra paragraphs needed</span></span><br><span class=\"line\">    WORD   e_ss;                        <span class=\"comment\">// Initial (relative) SS value</span></span><br><span class=\"line\">    WORD   e_sp;                        <span class=\"comment\">// Initial SP value</span></span><br><span class=\"line\">    WORD   e_csum;                      <span class=\"comment\">// Checksum</span></span><br><span class=\"line\">    WORD   e_ip;                        <span class=\"comment\">// Initial IP value</span></span><br><span class=\"line\">    WORD   e_cs;                        <span class=\"comment\">// Initial (relative) CS value</span></span><br><span class=\"line\">    WORD   e_lfarlc;                    <span class=\"comment\">// File address of relocation table</span></span><br><span class=\"line\">    WORD   e_ovno;                      <span class=\"comment\">// Overlay number</span></span><br><span class=\"line\">    WORD   e_res[<span class=\"number\">4</span>];                    <span class=\"comment\">// Reserved words</span></span><br><span class=\"line\">    WORD   e_oemid;                     <span class=\"comment\">// OEM identifier (for e_oeminfo)</span></span><br><span class=\"line\">    WORD   e_oeminfo;                   <span class=\"comment\">// OEM information; e_oemid specific</span></span><br><span class=\"line\">    WORD   e_res2[<span class=\"number\">10</span>];                  <span class=\"comment\">// Reserved words</span></span><br><span class=\"line\">    DWORD   e_lfanew;                    <span class=\"comment\">// File address of new exe header\t0x3c</span></span><br><span class=\"line\">&#125; IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>DOS 头目前已经没有什么作用了，保留的目的是为了向下兼容 16 位程序</p>\n<p><img data-src=\"C:%5CUsers%5C32644%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220512103830333.png\" alt=\"image-20220512103830333\"></p>\n<p>0x3c 地址的数据是 0x000000d8,（windows 中，高地址在前。）这里指向的是数据存储的起点，但不是程序入口。这里指向的是 PE</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">iMAGE_NT_HEADERS</span>&#123;</span></span><br><span class=\"line\"><span class=\"number\">0x00</span>\tDWORD Signature</span><br><span class=\"line\"><span class=\"number\">0x04</span>\t_iMAGE_FILE_HEADER FileHeader</span><br><span class=\"line\"><span class=\"number\">0x18</span>\t_iMAGE_OPTIONAL_HEADER OptionalHeader</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"程序入口\"><a class=\"markdownIt-Anchor\" href=\"#程序入口\">#</a> 程序入口</h2>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">IMAGE_OPTIONAL_HEADER</span> &#123;</span></span><br><span class=\"line\">  WORD                 Magic;</span><br><span class=\"line\">  BYTE                 MajorLinkerVersion;</span><br><span class=\"line\">  BYTE                 MinorLinkerVersion;</span><br><span class=\"line\">  DWORD                SizeOfCode;</span><br><span class=\"line\">  DWORD                SizeOfInitializedData;</span><br><span class=\"line\">  DWORD                SizeOfUninitializedData;</span><br><span class=\"line\">  DWORD                AddressOfEntryPoint;\t\t\t<span class=\"comment\">//入口点</span></span><br><span class=\"line\">  DWORD                BaseOfCode;\t\t\t\t\t<span class=\"comment\">//代码基址</span></span><br><span class=\"line\">  DWORD                BaseOfData;\t\t\t\t\t<span class=\"comment\">//数据基址</span></span><br><span class=\"line\">  DWORD                ImageBase;\t\t\t\t\t<span class=\"comment\">//镜像基址</span></span><br><span class=\"line\">  DWORD                SectionAlignment;</span><br><span class=\"line\">  DWORD                FileAlignment;</span><br><span class=\"line\">  WORD                 MajorOperatingSystemVersion;</span><br><span class=\"line\">  WORD                 MinorOperatingSystemVersion;</span><br><span class=\"line\">  WORD                 MajorImageVersion;</span><br><span class=\"line\">  WORD                 MinorImageVersion;</span><br><span class=\"line\">  WORD                 MajorSubsystemVersion;</span><br><span class=\"line\">  WORD                 MinorSubsystemVersion;</span><br><span class=\"line\">  DWORD                Win32VersionValue;</span><br><span class=\"line\">  DWORD                SizeOfImage;</span><br><span class=\"line\">  DWORD                SizeOfHeaders;</span><br><span class=\"line\">  DWORD                CheckSum;</span><br><span class=\"line\">  WORD                 Subsystem;</span><br><span class=\"line\">  WORD                 DllCharacteristics;</span><br><span class=\"line\">  DWORD                SizeOfStackReserve;</span><br><span class=\"line\">  DWORD                SizeOfStackCommit;</span><br><span class=\"line\">  DWORD                SizeOfHeapReserve;</span><br><span class=\"line\">  DWORD                SizeOfHeapCommit;</span><br><span class=\"line\">  DWORD                LoaderFlags;</span><br><span class=\"line\">  DWORD                NumberOfRvaAndSizes;</span><br><span class=\"line\">  IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><br><span class=\"line\">&#125; IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;</span><br></pre></td></tr></table></figure>\n<p><em>iMAGE_OPTIONAL_HEADER OptionalHeader   结构体紧跟在</em>    iMAGE_NT_HEADERS 的后面。</p>\n<p>AddressOfEntryPoint 在结构体中的偏移是 0x10,</p>\n<p>上面的截图为例，入口点在 0x100h，数据是 0x00001307</p>\n<p>代码基址是 0x00001000, 数据段基址 0x00006000。这里我们通过 ida 分析发现，</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.text:<span class=\"number\">00401000</span> ;</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; +-------------------------------------------------------------------------+</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; |      This file was generated by The Interactive <span class=\"title function_\">Disassembler</span> <span class=\"params\">(IDA)</span>      |</span><br><span class=\"line\">.text:00401000 ; |           Copyright (c) <span class=\"number\">2020</span> Hex-Rays, &lt;support@hex-rays.com&gt;           |</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; |                      License info: <span class=\"number\">50</span><span class=\"number\">-5947</span><span class=\"number\">-5F</span>4E<span class=\"number\">-42</span>                      |</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; |                      P.Y.G Team, Personal license                       |</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; +-------------------------------------------------------------------------+</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ;</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Input SHA256 : F6BCC742755C60202D85EDD7307567103C8804F2249D16591040A3390E571CBE</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Input MD5    : <span class=\"number\">3</span>D47DDF04CC6A8120C400A5F304E3ED6</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Input CRC32  : <span class=\"number\">4F</span>14BDF8</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span></span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; File Name   : C:\\Users\\<span class=\"number\">32644</span>\\Desktop\\reverse\\csaw2013reversing2\\<span class=\"number\">0453</span>d21297a743e199d8a7de75179e52 (<span class=\"number\">1</span>).exe</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Format      : Portable executable <span class=\"keyword\">for</span> <span class=\"number\">80386</span> (PE)</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Imagebase   : <span class=\"number\">400000</span></span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Timestamp   : <span class=\"number\">54123</span>A17 (Fri Sep <span class=\"number\">12</span> <span class=\"number\">00</span>:<span class=\"number\">11</span>:<span class=\"number\">03</span> <span class=\"number\">2014</span>)</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Section <span class=\"number\">1.</span> (virtual address <span class=\"number\">00001000</span>)</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Virtual size                  : <span class=\"number\">000044</span>D2 (  <span class=\"number\">17618.</span>)</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Section size in file          : <span class=\"number\">00004600</span> (  <span class=\"number\">17920.</span>)</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Offset to raw data <span class=\"keyword\">for</span> section: <span class=\"number\">00000400</span></span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Flags <span class=\"number\">60000020</span>: Text Executable Readable</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Alignment     : <span class=\"keyword\">default</span></span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; PDB File Name : C:\\Users\\exploitation\\documents\\visual studio <span class=\"number\">2010</span>\\Projects\\csaw2013reversing2\\Release\\csaw2013reversing2.pdb</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; OS type         :  MS Windows</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span> ; Application type:  Executable <span class=\"number\">32b</span>it</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span></span><br><span class=\"line\">.text:<span class=\"number\">00401000</span>                 <span class=\"number\">.686</span>p</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span>                 .mmx</span><br><span class=\"line\">.text:<span class=\"number\">00401000</span>                 .model flat</span><br><span class=\"line\">...</span><br><span class=\"line\">.text:<span class=\"number\">00405600</span> _text           ends</span><br><span class=\"line\">.text:<span class=\"number\">00405600</span></span><br><span class=\"line\">.idata:<span class=\"number\">00406000</span> ; Section <span class=\"number\">2.</span> (virtual address <span class=\"number\">00006000</span>)</span><br></pre></td></tr></table></figure>\n<p>这个两个基址，其实是相对地址，也就是关于镜像基址（BaseOfImage）的偏移</p>\n",
            "tags": [
                "逆向"
            ]
        }
    ]
}